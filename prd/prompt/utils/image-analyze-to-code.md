## Overview

- 이미지를 분석하여 디자인 스펙을 추출하고, 이를 기반으로 기존 코드를 리팩토링한다.
- 두 단계의 프롬프트를 순차적으로 실행하여 이미지에서 코드까지의 변환 프로세스를 완성한다.
- 시각적 스타일링에만 집중하며, 기능 로직은 변경하지 않는다.

## Input

- **이미지 파일**: 분석 대상 UI 스크린샷 또는 디자인 이미지
  - 이미지 형식: PNG, JPG, WebP 등 일반적인 이미지 포맷
  - 이미지 내용: 웹 UI 컴포넌트, 테이블, 폼, 대시보드 등
- **기존 feature.tsx 파일**: 리팩토링 대상이 되는 현재 구현 파일
- **참조 프롬프트 파일**:
  - `vision/prompt/utils/image-analyzer.md`: 이미지 분석 프롬프트
  - `vision/prompt/utils/spec-to-code.md`: 스펙 기반 코드 리팩토링 프롬프트
  - `vision/prompt/context/design-system.md`: 디자인 시스템 가이드라인

## Output

- **리팩토링된 feature.tsx 파일**: 이미지에서 추출한 디자인 스펙을 준수하는 코드
- **중간 산출물**: `{image_name}-design-spec.md` 디자인 스펙 문서
- **품질 기준**:
  - 이미지의 시각적 요소가 정확히 반영됨
  - 스펙에 명시된 디자인 토큰을 정확히 사용
  - 시각적 스타일링만 변경, 기능 로직은 유지
  - 기존 기능 동작 보장

## Step

**중요: 각 단계는 반드시 순차적으로 완료해야 한다. 한 번에 여러 단계를 진행하지 않는다. 각 단계 완료 후 중간 결과를 확인하고 다음 단계로 진행한다.**

### 1단계: 이미지 분석 및 스펙 추출

**실행 규칙:**
- 이 단계만 먼저 완료한다. 다른 단계로 진행하지 않는다.
- 완료 후 사용자에게 보고하고 다음 단계로 진행한다.

**작업 내용:**
- `vision/prompt/utils/image-analyzer.md` 프롬프트를 로드하고 실행한다.
- 입력 이미지를 `image-analyzer.md`의 Input으로 전달한다.
- `image-analyzer.md`의 Task 프로세스를 따라 디자인 스펙 문서를 생성한다.
- 생성된 `{image_name}-design-spec.md` 파일을 다음 단계의 입력으로 준비한다.
- 사용자에게 1단계 완료 및 생성된 스펙 문서를 보고한다.

**완료 조건:**
- 디자인 스펙 문서 생성 완료
- 스펙 문서 파일 저장 완료
- 사용자에게 1단계 완료 보고

### 2단계: 스펙 기반 코드 리팩토링

**실행 규칙:**
- 1단계가 완료된 후에만 시작한다.
- 1단계에서 생성된 스펙 문서를 반드시 확인한다.
- 완료 후 사용자에게 보고하고 다음 단계로 진행한다.

**작업 내용:**
- 1단계에서 생성된 `{image_name}-design-spec.md` 파일을 읽어 확인한다.
- `vision/prompt/utils/spec-to-code.md` 프롬프트를 로드하고 실행한다.
- 1단계에서 생성된 디자인 스펙 문서와 기존 feature.tsx 파일을 `spec-to-code.md`의 Input으로 전달한다.
- `spec-to-code.md`의 Task 프로세스를 따라 코드를 리팩토링한다.
- 스펙의 모든 디자인 토큰이 정확히 적용되었는지 확인한다.
- Lint 오류를 확인하고 수정한다.
- 사용자에게 2단계 완료 및 리팩토링 결과를 보고한다.

**완료 조건:**
- 코드 리팩토링 완료
- 스펙의 모든 디자인 토큰 적용 확인
- Lint 오류 없음
- 사용자에게 2단계 완료 보고

### 3단계: 검증 및 완성

**실행 규칙:**
- 2단계가 완료된 후에만 시작한다.
- 최종 검증만 수행한다.

**작업 내용:**
- 리팩토링된 코드가 이미지의 시각적 요소를 정확히 반영하는지 확인한다.
- 기능 로직이 변경되지 않았는지 최종 점검한다.
- 시각적 스타일링만 변경되었는지 검증한다.
- 최종 Lint 검사를 수행한다.
- 사용자에게 작업 완료를 보고한다.

**완료 조건:**
- 시각적 요소 반영 확인 완료
- 기능 로직 변경 없음 확인
- 최종 Lint 검사 통과
- 사용자에게 작업 완료 보고

## 실행 원칙

### 단계별 진행 규칙

1. **순차 실행**: 각 단계는 반드시 이전 단계가 완료된 후에만 시작한다.
2. **중간 확인**: 각 단계 완료 후 생성된 결과물을 확인하고 사용자에게 보고한다.
3. **검증 필수**: 각 단계 완료 후 다음 단계로 진행하기 전에 완료 조건을 확인한다.
4. **프롬프트 준수**: 각 단계는 해당 프롬프트 파일의 Task 섹션을 정확히 따른다.
5. **결과물 검증**: 중간 결과물은 다음 단계의 입력으로 사용되므로 형식과 내용을 정확히 준수한다.

### 금지 사항

- 한 번에 여러 단계를 동시에 진행하지 않는다.
- 단계 완료 전에 다음 단계로 진행하지 않는다.
- 중간 결과물 확인 없이 다음 단계로 진행하지 않는다.
- 중간 보고 없이 작업을 진행하지 않는다.
- 프롬프트 파일 참조는 상대 경로를 사용하여 명확히 명시한다.
