## Overview

- 단일 책임 원칙(SRP)을 준수하여 테스트 가능한 코드로 리팩토링한다.
- UI, Data, Interaction 컴포넌트 간 관심사를 명확히 분리한다.
- 컴포넌트 합성과 레이어 구조로 테스트 용이성을 높인다.

## Input

### 필수 문서

- **리팩토링 대상 파일**: 리팩토링이 필요한 컴포넌트 또는 모듈 파일
  - 파일이 존재하지 않으면 작업을 중단하고 사용자에게 알린다.

### 참고 문서

- `vision/prompt/context/design-system.md`: 디자인 컴포넌트 가이드라인
- `vision/prompt/utils/devils-advocate.md`: devil's advocate 가이드라인

## Output

- **리팩토링된 코드**: SRP를 준수하고 테스트 가능하도록 개선된 코드
  - UI 컴포넌트, Data 컴포넌트, Interaction 컴포넌트로 분리 완료
  - 각 컴포넌트의 props 개수가 5개 미만으로 제한
  - 함수 단위가 작고 명확한 책임을 가짐
  - 컴포넌트 합성으로 레이어 구조 구현
  - 낮은 결합도 유지

## Step

**실행 규칙 (모든 단계 공통):**
- 순차 실행: N단계 완료 후 N+1단계 시작
- 단일 집중: 현재 단계만 완료하고 다음 단계로 진행하지 않음
- 완료 검증: 완료 조건 충족 후 다음 단계 진행

### 1단계: Input 파일 분석 및 검증

**필수 문서와 참고 문서를 구분하여 분석:**
- 리팩토링 대상 파일 존재 확인 및 읽기
- 현재 구조 파악
  - 책임 범위 식별 (UI/Data/Interaction 혼재 여부)
  - Props 개수 및 복잡도
  - 함수 크기 및 책임 범위
  - 결합도
- 참고 문서 제공 시 의존성 확인
- 리팩토링 전략 수립

**완료:** ✓ 구조 분석 ✓ 문제점 식별 ✓ 전략 수립

### 2단계: 관심사 분리 설계

**3가지 컴포넌트 타입으로 분리 설계:**
- UI: 순수 렌더링 로직
- Data: 데이터 fetching, 상태 관리
- Interaction: 이벤트 처리, 비즈니스 로직
- 컴포넌트 간 인터페이스 및 데이터 흐름 정의
- Props 5개 미만 제한 방안 (object 묶기 금지, 내부 데이터 활성화 방식 우선)

**완료:** ✓ UI/Data/Interaction 분리 ✓ 인터페이스 정의 ✓ Props 제한 방안

### 3단계: 함수 단위 분해

**작은 단위로 함수 분해:**
- 큰 함수 → 작은 단위 분해
- 각 함수 단일 책임 보장
- 함수 간 의존성 최소화
- 유틸리티 함수 추출

**완료:** ✓ 함수 분해 ✓ 단일 책임 확인

### 4단계: 컴포넌트 합성 구조 구현

**레이어 구조로 컴포넌트 합성:**
- UI/Data/Interaction 컴포넌트 조합
- 레이어 구조 구축
- 의존성 주입으로 결합도 관리

**완료:** ✓ 합성 구조 ✓ 레이어 구조 ✓ 낮은 결합도

### 5단계: 코드 리팩토링 실행

**설계 기반 실제 코드 작성:**
- 원본 수정 또는 파일 분리
- UI: 렌더링만 | Data: fetching/상태만 | Interaction: 이벤트/로직만
- Props 5개 미만 검증 (개별 카운트)
- 큰 함수 분해

**완료:** ✓ 컴포넌트 분리 ✓ Props <5 ✓ 함수 분해

### 5-1단계: 리팩토링 결과 검증

**검증 체크리스트:**
- 단일 책임 준수
- Props <5개 재확인
- 낮은 결합도
- 독립 테스트 가능 구조
- 레이어 구조 올바름

**완료:** ✓ 모든 검증 통과 ✓ 테스트 가능 구조

### 5-2단계: Design System 사용 점검 및 개선

**의존성 트리 전체 점검:**
- 대상 파일 및 import된 모든 파일 재귀 탐색
- 의존성 트리 구성

**Design System 검증:**
- 커스텀 스타일 → design-system 컴포넌트 대체 가능 여부
- `common/design-system/` 활용 여부
- inline style, 중복 스타일 확인
- 가이드라인 준수 검증

**개선 실행:**
- design-system 컴포넌트로 대체
- 디자인 토큰 적용
- 커스텀 스타일 제거

**완료:** ✓ 의존성 트리 ✓ Design system 점검 ✓ 개선 적용

### 6단계: 결과 제공 및 피드백

**최종 결과 정리:**
- 코드 저장
- 변경 사항 요약
- 추가 수정 필요 사항 전달

**완료:** ✓ 저장 ✓ 피드백 제공

## 실행 원칙

### 금지 사항
- 여러 단계 동시 진행 금지
- 필수 문서 미확인 시 작업 진행 금지
- Object로 props 묶어 개수 축소 금지
- 복잡한 props 외부 주입 금지 (내부 데이터 활성화 방식 우선)

### 품질 기준

**컴포넌트:** 단일 책임 | 작은 크기 | 낮은 결합도 | 높은 응집도

**Props:** <5개 제한 | Object 묶기 금지 | 내부 데이터 활성화 우선

**테스트:** 독립 테스트 가능 | 인터페이스 기반 의존성 주입 | Mocking 용이
